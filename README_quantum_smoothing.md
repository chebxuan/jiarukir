# 量子图像平滑处理系统

## 项目概述

本项目实现了一个基于量子计算的图像平滑处理系统，使用Qiskit框架构建量子电路来计算图像的平滑系数。该系统演示了如何将量子计算技术应用于经典的图像处理问题。

## 功能特性

1. **量子S变换**: 使用量子电路实现图像平滑的核心算法
2. **量子加法器**: 构建量子加法器电路计算像素平均值
3. **2x2块处理**: 以2x2像素块为单位进行图像处理
4. **可视化对比**: 生成原始图像与平滑图像的对比图
5. **电路图生成**: 自动保存量子电路的可视化图像

## 文件结构

```
├── quantum_image_smoothing_simple.py    # 简化版主程序
├── quantum_image_smoothing.py           # 完整版主程序  
├── test_quantum_smoothing.py            # 测试脚本
├── requirements.txt                     # 依赖包列表
├── quantum_smoothing_comparison.png     # 完整对比图
├── quantum_smoothing_local_comparison.png # 局部对比图
└── README_quantum_smoothing.md          # 本文档
```

## 算法原理

### 量子S变换

对于每个2x2像素块：
```
[p0, p1]
[p2, p3]
```

使用量子电路计算平滑系数：
- A1 = floor((p0 + p1) / 2)
- A2 = floor((p2 + p3) / 2)

输出平滑块：
```
[A1, A1]
[A2, A2]
```

### 量子加法器实现

1. **输入编码**: 将8位像素值缩放到3位精度 (0-255 → 0-7)
2. **量子寄存器**: 
   - `qr_a`: 存储第一个操作数
   - `qr_b`: 存储第二个操作数
   - `qr_sum`: 存储加法结果
3. **量子门操作**:
   - CNOT门实现XOR操作
   - Toffoli门实现进位逻辑
4. **测量与解码**: 测量结果并转换回经典值

## 安装与运行

### 1. 安装依赖

```bash
pip install qiskit qiskit-aer numpy matplotlib
```

或使用requirements文件：
```bash
pip install -r requirements.txt
```

### 2. 运行测试

```bash
python3 test_quantum_smoothing.py
```

### 3. 运行完整程序

```bash
python3 quantum_image_smoothing_simple.py
```

## 输出结果

### 控制台输出
- 数据准备信息
- 量子电路处理过程
- 统计信息对比
- 生成文件列表

### 生成文件
1. **quantum_smoothing_comparison.png**: 原始图像、平滑图像、差异图像的对比
2. **quantum_smoothing_local_comparison.png**: 局部区域(64x64)的详细对比
3. **quantum_circuit_block_*.png**: 量子电路图(如果安装了pylatexenc)

## 技术特点

### 量子优势
- **并行计算**: 量子叠加态允许同时处理多个状态
- **量子纠缠**: 利用量子比特间的关联性
- **量子测量**: 通过测量获取计算结果

### 工程实现
- **错误处理**: 包含量子电路执行失败的备选方案
- **精度控制**: 通过位精度缩放平衡性能与准确性
- **可视化**: 自动生成电路图和结果对比图
- **模块化**: 清晰的函数分离和代码组织

## 性能统计

运行示例的统计结果：
- **处理块数**: 16,384个2x2块
- **原始图像**: 均值=126.95, 标准差=73.72
- **平滑图像**: 均值=126.69, 标准差=52.17
- **平均差异**: 42.51

## 技术限制

1. **量子比特限制**: 受模拟器量子比特数量限制
2. **精度缩放**: 为减少电路复杂度而降低了位精度
3. **噪声影响**: 实际量子硬件中会有量子噪声
4. **经典备选**: 复杂电路失败时使用经典计算

## 扩展方向

1. **增加精度**: 使用更高位精度的量子电路
2. **优化算法**: 实现更高效的量子加法器
3. **硬件适配**: 适配真实量子硬件的限制
4. **算法扩展**: 实现其他量子图像处理算法

## 量子电路示例

程序会显示量子电路的文本表示：

```
          ┌───┐ ░                                          ░             
     a_0: ┤ X ├─░───■─────────■────────────────────────────░─────────────
          ├───┤ ░   │         │                            ░             
     a_1: ┤ X ├─░───┼─────────┼────■─────────■─────────────░─────────────
          └───┘ ░   │         │    │         │             ░             
     a_2: ──────░───┼─────────┼────┼─────────┼────■────────░─────────────
                ░   │         │    │         │    │        ░             
     b_0: ──────░───┼────■────■────┼─────────┼────┼────────░─────────────
          ┌───┐ ░   │    │    │    │         │    │        ░             
     b_1: ┤ X ├─░───┼────┼────┼────┼────■────■────┼────────░─────────────
          ├───┤ ░   │    │    │    │    │    │    │        ░             
     b_2: ┤ X ├─░───┼────┼────┼────┼────┼────┼────┼────■───░─────────────
          └───┘ ░ ┌─┴─┐┌─┴─┐  │    │    │    │    │    │   ░ ┌─┐         
   sum_0: ──────░─┤ X ├┤ X ├──┼────┼────┼────┼────┼────┼───░─┤M├─────────
                ░ └───┘└───┘┌─┴─┐┌─┴─┐┌─┴─┐  │    │    │   ░ └╥┘┌─┐      
   sum_1: ──────░───────────┤ X ├┤ X ├┤ X ├──┼────┼────┼───░──╫─┤M├──────
                ░           └───┘└───┘└───┘┌─┴─┐┌─┴─┐┌─┴─┐ ░  ║ └╥┘┌─┐   
   sum_2: ──────░──────────────────────────┤ X ├┤ X ├┤ X ├─░──╫──╫─┤M├───
                ░                          └───┘└───┘└───┘ ░  ║  ║ └╥┘┌─┐
   sum_3: ──────░──────────────────────────────────────────░──╫──╫──╫─┤M├
                ░                                          ░  ║  ║  ║ └╥┘
result: 4/════════════════════════════════════════════════════╩══╩══╩══╩═
                                                              0  1  2  3 
```

## 作者

量子计算工程师 - 专精Python、Numpy和Qiskit的量子计算应用

## 许可证

本项目仅供学习和研究使用。